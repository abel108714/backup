CREATE Table mssq(
    id bigint(255) NOT NULL, #id+店號+年
    store_code varchar(50) character set utf8, #店號
    product_id bigint(255) NOT NULL, #id
    product_name varchar(50) character set utf8, #品名
    year varchar(50) character set utf8, #年
    january varchar(50) character set utf8, #一月
    february varchar(50) character set utf8, #二月
    march varchar(50) character set utf8, #三月
    april varchar(50) character set utf8, #四月
    may varchar(50) character set utf8, #五月
    june varchar(50) character set utf8, #六月
    july varchar(50) character set utf8, #七月
    august varchar(50) character set utf8, #八月
    september varchar(50) character set utf8, #九月
    october varchar(50) character set utf8, #十月
    november varchar(50) character set utf8, #十一月
    december varchar(50) character set utf8, #十二月	
    PRIMARY KEY (id) #設定主鍵
)ENGINE = InnoDB;


    sum(january,february,march,april,may,june,july,august,september,october,november,december)



CREATE Table ssq(
    id bigint(255) NOT NULL, #id=品號+店號+年+月
    year varchar(50) character set utf8, #年
    month varchar(50) character set utf8, #月
    product_id bigint(255) NOT NULL, #品號
    store_code varchar(50) character set utf8, #店號
    product_name varchar(50) character set utf8, #品名
    spec varchar(50) character set utf8, #規格
    sales_quantity varchar(50) character set utf8, #銷貨數量
    total_sales varchar(50) character set utf8, #銷售總額
    total_sales_before_tax varchar(50) character set utf8, #未稅銷售總金額
    average_unit_price varchar(50) character set utf8, #平均單價
    net_sales varchar(50) character set utf8, #銷售淨額
    total_amount_of_discount varchar(50) character set utf8, #折價總金額
    number_of_giveaways varchar(50) character set utf8, #贈品數量
    weight varchar(50) character set utf8, #重量
    giveaway_weight varchar(50) character set utf8, #贈品重量
    cost_of_goods_sold varchar(50) character set utf8, #銷貨成本
    gross_sales varchar(50) character set utf8, #銷售毛利
    gross_profit_margin varchar(50) character set utf8, #毛利率
    datetime timestamp default CURRENT_TIMESTAMP, #資料儲存時間
    PRIMARY KEY (id) #設定主鍵
)ENGINE = InnoDB;

insertMssq()







ALTER TABLE members ADD COLUMN sum() int(50) DEFAULT 0;

ALTER TABLE mssq ADD COLUMN sum(january,february,march,april,may,june,july,august,september,october,november,december) int(50) DEFAULT 0;


datetime timestamp default CURRENT_TIMESTAMP



UPDATE mssq SET january=100


select sales_quantity from ssq where id = 1010100121101202202;


select sales_quantity from ssq where year = 2022 and month = 2 and product_id = 10101001 and store_code = 21101;


#今天是月底，則計算各品號加總儲存至
select sum(sales_quantity) from ssq where year = 2022 and month = 2 and product_id = 10101001;
update mssq SET january=


         select getColumnNameWithIndex('ssq','ssq_index',a) into @ColName;

         SET @select_ssq_colname = CONCAT('SELECT sum(',@ColName,') into @ss FROM ssq where product_id = ',product_id,' and year=(select year(now()))');
         PREPARE ins FROM @select_ssq_colname;
         EXECUTE ins;






#     id
#     product_id
#     store_code
#     product_name
#     spec
#     sales_quantity
#     total_sales
#     total_sales_before_tax
#     average_unit_price
#     net_sales
#     total_amount_of_discount
#     number_of_giveaways
#     weight
#     giveaway_weight
#     cost_of_goods_sold
#     gross_sales
#     gross_profit_margin



# WINXPSP2 RUNASADMIN
HKCU\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers (value for devenv.exe was "^ WIN8RTM")

1. 登入MySQL server
mysql -uroot -p

2. 建資料庫
CREATE DATABASE membersDB;

3. 查看系統自建的資料庫
show databases;

4. 選擇要使用的資料庫
use membersDB;

5. 建表
CREATE TABLE members (
	Department varchar(50),
	Name varchar(50),
	Target integer(50)
);

CREATE TABLE members (
	UID INT NOT NULL AUTO_INCREMENT,
	Department varchar(50),
	Name varchar(50),
	Target integer(50),
	PRIMARY KEY(UID)
);

CREATE TABLE members (
	UID INT NOT NULL AUTO_INCREMENT,
	Dept varchar(50) character set utf8,
	Name varchar(50) character set utf8,
	Target integer(50),
	PRIMARY KEY(UID)
);

CREATE TABLE members (
	UID integer(255) NOT NULL,
	Department varchar(50) NOT NULL,
	Name varchar(50) NOT NULL,
	Target integer(50),
	PRIMARY KEY(UID)
); ALTER TABLE members ADD Check_field VARCHAR(1) NOT NULL;


ALTER TABLE members ADD Date_created VARCHAR(50);
ALTER TABLE members ADD Date_modified VARCHAR(50);
ALTER TABLE members ADD Day_performance integer(50);
ALTER TABLE members ADD Total_cumulative_performance integer(50);
ALTER TABLE members ADD Reach_rate VARCHAR(50);


ALTER TABLE members ADD BGM integer(50);
ALTER TABLE members ADD BGC integer(50);
ALTER TABLE members ADD TH integer(50);
ALTER TABLE members ADD IRHD integer(50);

ALTER TABLE members CHANGE Datecreated Date_created varchar(50);
ALTER TABLE members CHANGE DateModified Date_modified varchar(50);
ALTER TABLE members CHANGE Date_created VARCHAR(50);
ALTER TABLE members CHANGE Check_field Check_F VARCHAR(50);
ALTER TABLE members CHANGE Department Dept. VARCHAR(50);
ALTER TABLE members CHANGE Date_created D_created varchar(50);
ALTER TABLE members CHANGE Date_modified D_modified varchar(50);

ALTER TABLE members CHANGE Reach_rate Reach_R varchar(50);
ALTER TABLE members CHANGE Check_F Chk VARCHAR(50);

CREATE TABLE members (
	UID integer(255) NOT NULL,
	Department varchar(50) NOT NULL,
	Name varchar(50) NOT NULL,
	Day_performance integer(50),
	Total_cumulative_performance integer(50),
	Target integer(50),
	Reach_rate VARCHAR(50),
	Check_field integer(1) NOT NULL,
	Date_created VARCHAR(50) NOT NULL,
	Date_modified VARCHAR(50) NOT NULL,
	PRIMARY KEY(UID)
);
CREATE TABLE tmp_members (
	UID integer(255) NOT NULL,
	Department varchar(50) NOT NULL,
	Name varchar(50) NOT NULL,
	Day_performance integer(50),
	Total_cumulative_performance integer(50),
	Target integer(50),
	Reach_rate VARCHAR(50),
	Check_field integer(1) NOT NULL,
	Date_created VARCHAR(50) NOT NULL,
	Date_modified VARCHAR(50) NOT NULL,
	PRIMARY KEY(UID)
);


CREATE TABLE members (
	UID integer(255) NOT NULL AUTO_INCREMENT,
	Dept varchar(50) character set utf8,
	Name varchar(50) character set utf8,
	DP integer(50),
	TP integer(50),
	Target integer(50),
	Reach_R VARCHAR(50),
	BGM_DP integer(50),
	BGM_TP integer(50),
	BGC_DP integer(50),
	BGC_TP integer(50),
	TH_DP integer(50),
	TH_TP integer(50),
	IRHD_DP  integer(50),
	IRHD_TP integer(50),
	Chk integer(1) NOT NULL,
	D_created VARCHAR(50) NOT NULL,
	D_modified VARCHAR(50) NOT NULL,
	PRIMARY KEY(UID)
);
CREATE TABLE tmp_members (
	UID integer(255) NOT NULL,
	Dept varchar(50) NOT NULL,
	Name varchar(50) NOT NULL,
	D_perf integer(50),
	T_perf integer(50),
	Target integer(50),
	Reach_R VARCHAR(50),
	Chk integer(1) NOT NULL,
	D_created VARCHAR(50) NOT NULL,
	D_modified VARCHAR(50) NOT NULL,
	PRIMARY KEY(UID)
);






*備份table
INSERT INTO tmp_members
SELECT * FROM members;

*刪除table
drop table members;

*更改table名稱
rename table tmp_members to members;

*查看欄位
(詳列)
show columns from members;
(只有欄位)
SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_SCHEMA = 'membersDB' AND TABLE_NAME = 'members';

*欄位重新命名
ALTER TABLE `members` CHANGE `Day_performance` `D_perf` INT(50);
ALTER TABLE `members` CHANGE `Total_cumulative_performance` `T_perf` INT(50);

*D_perf欄位資料複製到target欄位
update members set target = D_perf;

*某欄百分比顯示
select * from members where case reach_R then reach_R = concat(reach_R * 100 - MOD(reach_R * 100,1), "%");

select concat(reach_R * 100 - MOD(reach_R * 100,1), "%") as Rate from members;

SELECT REPLACE(reach_R,MOD(reach_R * 100,1),"%") as Rate from members;

SELECT Store_Name, SUM(Sales) 
FROM Store_Information 
GROUP BY Store_Name
HAVING SUM(Sales) > 1500;

*百分比顯示
SELECT concat(ROUND(reach_R * 100, 0),"%") as rate FROM members;

SELECT * FROM members UNION SELECT concat(ROUND(reach_R * 100, 0),"%") as reach_R FROM members;



6. 新增資料
INSERT INTO members (UID,department, name, target)
VALUES ('45345GH','XX區', '李世民', '54685685');

INSERT INTO members (UID,department, name, target)
VALUES ('34','34', '34', '34');
INSERT INTO members (UID,department, name, target)
VALUES (35,34, 34, 34);
INSERT INTO members (UID,department, name, target)
VALUES (36,36, 36, 36);



CREATE TABLE members (
	UID INT NOT NULL AUTO_INCREMENT,
	Dept varchar(50) character set utf8,
	Name varchar(50) character set utf8,
	Target integer(50),
	PRIMARY KEY(UID)
);

CREATE TABLE members (
	UID INT NOT NULL AUTO_INCREMENT,
	Dept varchar(50),
	Name varchar(50),
	Target integer(50),
	PRIMARY KEY(UID)
);

INSERT INTO members (UID, dept, name, target)
VALUES('1','北區','李永齊','1550000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('2','北區','柯世鵬','1557213.00');
INSERT INTO members (UID, dept, name, target)
VALUES('3','北區','戴佐鈞','900000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('4','中區','李宏達','1000000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('5','中區','陳巧芬','1000000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('6','中區','梁玉林','1000000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('7','中區','林宜冠','620000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('8','南區','黃三和','1000000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('9','南區','林士傑','700000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('10','流通','陳永宗','3800000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('11','流通','陳騏毅','600000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('12','外銷','蔡政君','807234.00');
INSERT INTO members (UID, dept, name, target)
VALUES('13','外銷','許巧琪','1500000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('14','外銷','黃宥瑄','2100000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('15','外銷','楊智鈞','500000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('16','網電','張玉玲','3700000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('17','專案','張彩雲','0.00');
INSERT INTO members (UID, dept, name, target)
VALUES('18','專案','張嘉芬','350000.00');
INSERT INTO members (UID, dept, name, target)
VALUES('19','外銷','鄭文航','500000.00');



7. 查看table資料
SELECT * FROM members;

Select UID,Department,Name,Target from members;

Select UID AS 員工編號,Department AS 部門,Name AS 業務員,Target AS 業績目標 from members;

select UID,Dept,Name,D_perf,T_perf,Target,Reach_R,Chk,D_created,D_modified from members;




8. 查MySQL版本


9. 修改資料
UPDATE members SET target='666' WHERE UID='45345';
UPDATE members SET target='777' WHERE target='666';

10. 刪除資料
DELETE FROM members WHERE UID='34';







INSERT INTO members (UID, dept, name, target)
VALUES('1','北區','李永齊','1550000.00');








insert into members(UID,Dept,Name) values("41","北區","李永齊");
insert into members(UID,Dept,Name) values("149","北區","柯世鵬");
insert into members(UID,Dept,Name) values("1193","北區","戴佐鈞");
insert into members(UID,Dept,Name) values("21","中區","李宏達");
insert into members(UID,Dept,Name) values("1163","中區","林宜冠");
insert into members(UID,Dept,Name) values("145","中區","梁玉林");
insert into members(UID,Dept,Name) values("107","中區","陳巧芬");
insert into members(UID,Dept,Name) values("1099","南區","林士傑");
insert into members(UID,Dept,Name) values("65","南區","黃三和");
insert into members(UID,Dept,Name) values("98","流通","陳永宗");
insert into members(UID,Dept,Name) values("1113","流通","陳騏毅");
insert into members(UID,Dept,Name) values("82","外銷","許巧琪");
insert into members(UID,Dept,Name) values("108","外銷","黃宥瑄");
insert into members(UID,Dept,Name) values("1107","外銷","楊智鈞");
insert into members(UID,Dept,Name) values("23","外銷","蔡政君");
insert into members(UID,Dept,Name) values("19","網電","張玉玲");
insert into members(UID,Dept,Name) values("20","專案","張嘉芬");
insert into members(UID,Dept,Name) values("1195","外銷","鄭文航");



*自定義排序
select * from members
ORDER BY FIELD(Dept,'北區','中區','南區','流通','外銷','網電','專案'),CONVERT(`Name` using big5) asc;

select UID, Dept, Name from members
ORDER BY FIELD(Dept,'北區','中區','南區','流通','外銷','網電','專案'),CONVERT(`Name` using big5) asc;

select UID, Dept, Name from members
ORDER BY FIELD(Dept,'北區','中區','南區','流通','外銷','網電','專案'),CONVERT(`Name` using utf8) asc;

*計算有業績目標的人員數量
select count(*) from members where target > 0;
(查看可用having)
select * from members where target > 0;或select * from members having > 0;

*選擇有業績目標且chk=0的資料列插入各別部門

取得資料列存在Rs物件
select Dept,Name,DP,TP,Target,Reach_R,BGM_DP,BGM_TP,BGC_DP,BGC_TP,TH_DP,TH_TP,IRHD_DP,IRHD_TP from members where target > 0 and chk = 0;

先把資料列存到變數

取存放Dept欄位的變數值去excel欄位比對相同到不同就將資料列插入到上一列






清除資料表內容
TRUNCATE TABLE members;